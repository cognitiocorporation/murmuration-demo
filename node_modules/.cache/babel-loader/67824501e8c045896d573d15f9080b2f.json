{"ast":null,"code":"import _regeneratorRuntime from \"/usr/local/lib/node_modules/react-scripts/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/usr/local/lib/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/usr/local/lib/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/usr/local/lib/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"/usr/local/lib/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/usr/local/lib/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/usr/local/lib/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"/Users/angelvazquez/Dropbox/My Mac (Angels-MacBook-Pro-4.local)/Documents/Projects/Murmuration - 10:04:2021/src/components/layout/MainNavbar/NavbarNav/Notifications.js\";\nimport React from \"react\";\nimport { withRouter } from 'react-router';\nimport { NavItem, NavLink, Badge, Collapse, DropdownItem } from \"shards-react\";\nimport Parse from 'parse';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar currUser;\n\nvar Notifications = /*#__PURE__*/function (_React$Component) {\n  _inherits(Notifications, _React$Component);\n\n  var _super = _createSuper(Notifications);\n\n  function Notifications(props) {\n    var _this;\n\n    _classCallCheck(this, Notifications);\n\n    _this = _super.call(this, props);\n    _this.state = {\n      visible: false,\n      notificationCount: 0,\n      notificationMessages: []\n    };\n    _this.toggleNotifications = _this.toggleNotifications.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(Notifications, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      currUser = Parse.User.current();\n      this.getNotifications(currUser);\n    }\n  }, {\n    key: \"getNotifications\",\n    value: function () {\n      var _getNotifications = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(user) {\n        var query, results, count, messages;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                query = new Parse.Query(Parse.User);\n                query.equalTo(\"objectId\", user.id);\n                _context.next = 4;\n                return query.find();\n\n              case 4:\n                results = _context.sent;\n                count = results[0].get('notificationCount');\n                messages = results[0].get(\"notificationMessages\");\n                this.setState({\n                  notificationCount: count,\n                  notificationMessages: messages\n                });\n\n              case 8:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function getNotifications(_x) {\n        return _getNotifications.apply(this, arguments);\n      }\n\n      return getNotifications;\n    }()\n  }, {\n    key: \"resetCount\",\n    value: function () {\n      var _resetCount = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(user) {\n        var _this2 = this;\n\n        var query, results, currUser;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                query = new Parse.Query(Parse.User);\n                query.equalTo(\"objectId\", user.id);\n                _context2.next = 4;\n                return query.find();\n\n              case 4:\n                results = _context2.sent;\n                currUser = results[0];\n                currUser.set(\"notificationCount\", 0);\n                currUser.set(\"notificationMessages\", []);\n                _context2.next = 10;\n                return currUser.save().catch(function (error) {// This will error, since the Parse.User is not authenticated\n                }).then(function () {\n                  return _this2.setState({\n                    notificationCount: ''\n                  });\n                });\n\n              case 10:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      function resetCount(_x2) {\n        return _resetCount.apply(this, arguments);\n      }\n\n      return resetCount;\n    }()\n  }, {\n    key: \"toggleNotifications\",\n    value: function toggleNotifications() {\n      if (this.state.visible) {\n        this.removeMessages();\n      }\n\n      this.setState({\n        visible: !this.state.visible\n      });\n      this.resetCount(currUser);\n    }\n  }, {\n    key: \"removeMessages\",\n    value: function removeMessages() {\n      this.setState({\n        notificationMessages: []\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _this$state = this.state,\n          notificationCount = _this$state.notificationCount,\n          notificationMessages = _this$state.notificationMessages;\n      return /*#__PURE__*/_jsxDEV(NavItem, {\n        className: \"border-right dropdown notifications\",\n        children: [/*#__PURE__*/_jsxDEV(NavLink, {\n          className: \"nav-link-icon text-center\",\n          onClick: this.toggleNotifications,\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"nav-link-icon__wrapper\",\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"material-icons\",\n              children: \"\\uE7F4\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 80,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(Badge, {\n              pill: true,\n              theme: \"danger\",\n              children: notificationCount == 0 ? '' : notificationCount\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 81,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 79,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(Collapse, {\n          open: this.state.visible,\n          className: \"dropdown-menu dropdown-menu-small\",\n          children: notificationMessages.length > 0 ? notificationMessages.map(function (item, i) {\n            return /*#__PURE__*/_jsxDEV(DropdownItem, {\n              onClick: function onClick() {\n                return _this3.props.history.push(\"/idea-management\");\n              },\n              className: \"notification__all text-center\",\n              children: item\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 122,\n              columnNumber: 13\n            }, _this3);\n          }) : /*#__PURE__*/_jsxDEV(DropdownItem, {\n            className: \"notification__all text-center\",\n            children: \"No new notifications.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 14\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 7\n      }, this);\n    }\n  }]);\n\n  return Notifications;\n}(React.Component);\n\nexport default _c = withRouter(Notifications);\n\nvar _c;\n\n$RefreshReg$(_c, \"%default%\");","map":{"version":3,"sources":["/Users/angelvazquez/Dropbox/My Mac (Angels-MacBook-Pro-4.local)/Documents/Projects/Murmuration - 10:04:2021/src/components/layout/MainNavbar/NavbarNav/Notifications.js"],"names":["React","withRouter","NavItem","NavLink","Badge","Collapse","DropdownItem","Parse","currUser","Notifications","props","state","visible","notificationCount","notificationMessages","toggleNotifications","bind","User","current","getNotifications","user","query","Query","equalTo","id","find","results","count","get","messages","setState","set","save","catch","error","then","removeMessages","resetCount","length","map","item","i","history","push","Component"],"mappings":";;;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAAQC,UAAR,QAAyB,cAAzB;AACA,SAASC,OAAT,EAAkBC,OAAlB,EAA2BC,KAA3B,EAAkCC,QAAlC,EAA4CC,YAA5C,QAAgE,cAAhE;AACA,OAAOC,KAAP,MAAkB,OAAlB;;AAEA,IAAIC,QAAJ;;IAEMC,a;;;;;AACJ,yBAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,8BAAMA,KAAN;AAEA,UAAKC,KAAL,GAAa;AACXC,MAAAA,OAAO,EAAE,KADE;AAEXC,MAAAA,iBAAiB,EAAE,CAFR;AAGXC,MAAAA,oBAAoB,EAAE;AAHX,KAAb;AAMA,UAAKC,mBAAL,GAA2B,MAAKA,mBAAL,CAAyBC,IAAzB,+BAA3B;AATiB;AAUlB;;;;WAED,8BAAqB;AACnBR,MAAAA,QAAQ,GAAGD,KAAK,CAACU,IAAN,CAAWC,OAAX,EAAX;AACA,WAAKC,gBAAL,CAAsBX,QAAtB;AACD;;;;uFAED,iBAAuBY,IAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AACMC,gBAAAA,KADN,GACc,IAAId,KAAK,CAACe,KAAV,CAAgBf,KAAK,CAACU,IAAtB,CADd;AAEEI,gBAAAA,KAAK,CAACE,OAAN,CAAc,UAAd,EAA0BH,IAAI,CAACI,EAA/B;AAFF;AAAA,uBAGwBH,KAAK,CAACI,IAAN,EAHxB;;AAAA;AAGQC,gBAAAA,OAHR;AAIQC,gBAAAA,KAJR,GAIgBD,OAAO,CAAC,CAAD,CAAP,CAAWE,GAAX,CAAe,mBAAf,CAJhB;AAKQC,gBAAAA,QALR,GAKmBH,OAAO,CAAC,CAAD,CAAP,CAAWE,GAAX,CAAe,sBAAf,CALnB;AAME,qBAAKE,QAAL,CAAc;AACZjB,kBAAAA,iBAAiB,EAAEc,KADP;AAEZb,kBAAAA,oBAAoB,EAAEe;AAFV,iBAAd;;AANF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;;;;;;;;;;;iFAYA,kBAAiBT,IAAjB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AACMC,gBAAAA,KADN,GACc,IAAId,KAAK,CAACe,KAAV,CAAgBf,KAAK,CAACU,IAAtB,CADd;AAEEI,gBAAAA,KAAK,CAACE,OAAN,CAAc,UAAd,EAA0BH,IAAI,CAACI,EAA/B;AAFF;AAAA,uBAGwBH,KAAK,CAACI,IAAN,EAHxB;;AAAA;AAGQC,gBAAAA,OAHR;AAIQlB,gBAAAA,QAJR,GAImBkB,OAAO,CAAC,CAAD,CAJ1B;AAMElB,gBAAAA,QAAQ,CAACuB,GAAT,CAAa,mBAAb,EAAkC,CAAlC;AACAvB,gBAAAA,QAAQ,CAACuB,GAAT,CAAa,sBAAb,EAAqC,EAArC;AAPF;AAAA,uBAQQvB,QAAQ,CAACwB,IAAT,GAAgBC,KAAhB,CAAsB,UAAAC,KAAK,EAAI,CACnC;AACD,iBAFK,EAEHC,IAFG,CAEE;AAAA,yBACN,MAAI,CAACL,QAAL,CAAc;AACZjB,oBAAAA,iBAAiB,EAAE;AADP,mBAAd,CADM;AAAA,iBAFF,CARR;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;;;;;;;;;;WAiBA,+BAAsB;AACpB,UAAI,KAAKF,KAAL,CAAWC,OAAf,EAAwB;AACtB,aAAKwB,cAAL;AACD;;AACD,WAAKN,QAAL,CAAc;AACZlB,QAAAA,OAAO,EAAE,CAAC,KAAKD,KAAL,CAAWC;AADT,OAAd;AAGA,WAAKyB,UAAL,CAAgB7B,QAAhB;AACD;;;WAED,0BAAiB;AACf,WAAKsB,QAAL,CAAc;AACZhB,QAAAA,oBAAoB,EAAE;AADV,OAAd;AAGD;;;WAED,kBAAS;AAAA;;AACP,wBAAkD,KAAKH,KAAvD;AAAA,UAAOE,iBAAP,eAAOA,iBAAP;AAAA,UAA0BC,oBAA1B,eAA0BA,oBAA1B;AACA,0BACE,QAAC,OAAD;AAAS,QAAA,SAAS,EAAC,qCAAnB;AAAA,gCACE,QAAC,OAAD;AACE,UAAA,SAAS,EAAC,2BADZ;AAEE,UAAA,OAAO,EAAE,KAAKC,mBAFhB;AAAA,iCAIE;AAAK,YAAA,SAAS,EAAC,wBAAf;AAAA,oCACE;AAAG,cAAA,SAAS,EAAC,gBAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADF,eAEE,QAAC,KAAD;AAAO,cAAA,IAAI,MAAX;AAAY,cAAA,KAAK,EAAC,QAAlB;AAAA,wBACGF,iBAAiB,IAAI,CAArB,GAAwB,EAAxB,GAA2BA;AAD9B;AAAA;AAAA;AAAA;AAAA,oBAFF;AAAA;AAAA;AAAA;AAAA;AAAA;AAJF;AAAA;AAAA;AAAA;AAAA,gBADF,eAYE,QAAC,QAAD;AACE,UAAA,IAAI,EAAE,KAAKF,KAAL,CAAWC,OADnB;AAEE,UAAA,SAAS,EAAC,mCAFZ;AAAA,oBAmCGE,oBAAoB,CAACwB,MAArB,GAA6B,CAA7B,GAA+BxB,oBAAoB,CAACyB,GAArB,CAAyB,UAACC,IAAD,EAAOC,CAAP;AAAA,gCACvD,QAAC,YAAD;AAAc,cAAA,OAAO,EAAE;AAAA,uBAAM,MAAI,CAAC/B,KAAL,CAAWgC,OAAX,CAAmBC,IAAnB,CAAwB,kBAAxB,CAAN;AAAA,eAAvB;AAA0E,cAAA,SAAS,EAAC,+BAApF;AAAA,wBACWH;AADX;AAAA;AAAA;AAAA;AAAA,sBADuD;AAAA,WAAzB,CAA/B,gBAIE,QAAC,YAAD;AAAc,YAAA,SAAS,EAAC,+BAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAvCL;AAAA;AAAA;AAAA;AAAA,gBAZF;AAAA;AAAA;AAAA;AAAA;AAAA,cADF;AA8DD;;;;EA/HyBxC,KAAK,CAAC4C,S;;AAkIlC,oBAAe3C,UAAU,CAACQ,aAAD,CAAzB","sourcesContent":["import React from \"react\";\nimport {withRouter} from 'react-router';\nimport { NavItem, NavLink, Badge, Collapse, DropdownItem } from \"shards-react\";\nimport Parse from 'parse';\n\nvar currUser;\n\nclass Notifications extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      visible: false,\n      notificationCount: 0,\n      notificationMessages: []\n    };\n\n    this.toggleNotifications = this.toggleNotifications.bind(this);\n  }\n\n  componentWillMount() {\n    currUser = Parse.User.current();\n    this.getNotifications(currUser);\n  }\n\n  async getNotifications(user) {\n    var query = new Parse.Query(Parse.User);\n    query.equalTo(\"objectId\", user.id);\n    const results = await query.find();\n    const count = results[0].get('notificationCount');\n    const messages = results[0].get(\"notificationMessages\");\n    this.setState({\n      notificationCount: count,\n      notificationMessages: messages\n    });\n  }\n\n  async resetCount(user) {\n    var query = new Parse.Query(Parse.User);\n    query.equalTo(\"objectId\", user.id);\n    const results = await query.find();\n    const currUser = results[0];\n\n    currUser.set(\"notificationCount\", 0);\n    currUser.set(\"notificationMessages\", []);\n    await currUser.save().catch(error => {\n      // This will error, since the Parse.User is not authenticated\n    }).then(() => \n      this.setState({\n        notificationCount: '',\n      })\n    );\n  }\n\n  toggleNotifications() {\n    if (this.state.visible) {\n      this.removeMessages();\n    }\n    this.setState({\n      visible: !this.state.visible,\n    });\n    this.resetCount(currUser);\n  }\n\n  removeMessages() {\n    this.setState({\n      notificationMessages: [],\n    })\n  }\n\n  render() {\n    const {notificationCount, notificationMessages} = this.state;\n    return (\n      <NavItem className=\"border-right dropdown notifications\">\n        <NavLink\n          className=\"nav-link-icon text-center\"\n          onClick={this.toggleNotifications}\n        >\n          <div className=\"nav-link-icon__wrapper\">\n            <i className=\"material-icons\">&#xE7F4;</i>\n            <Badge pill theme=\"danger\">\n              {notificationCount == 0? '':notificationCount}\n            </Badge>\n          </div>\n        </NavLink>\n        <Collapse\n          open={this.state.visible}\n          className=\"dropdown-menu dropdown-menu-small\"\n        >\n          {/* <DropdownItem>\n            <div className=\"notification__icon-wrapper\">\n              <div className=\"notification__icon\">\n                <i className=\"material-icons\">&#xE6E1;</i>\n              </div>\n            </div>\n            <div className=\"notification__content\">\n              <span className=\"notification__category\">Progreso de Idea</span>\n              <p>\n                Su idea ha pasado al proximo nivel. {\" \"} Ha llegado al\n                <span className=\"text-success text-semibold\"> 50%</span> de terminacion.\n              </p>\n            </div>\n          </DropdownItem>\n          <DropdownItem>\n            <div className=\"notification__icon-wrapper\">\n              <div className=\"notification__icon\">\n                <i className=\"material-icons\">&#xE8D1;</i>\n              </div>\n            </div>\n            <div className=\"notification__content\">\n              <span className=\"notification__category\">Nueva Idea</span>\n              <p>\n                Hay una nueva idea para ser evaluada.{\" \"} Favor tomar\n                <span className=\"text-danger text-semibold\">accion</span>. \n              </p>\n            </div>\n          </DropdownItem> */}\n          {/* <DropdownItem className=\"notification__all text-center\">\n            View all Notifications\n          </DropdownItem> */}\n          {notificationMessages.length >0?notificationMessages.map((item, i) =>\n            <DropdownItem onClick={() => this.props.history.push(\"/idea-management\")} className=\"notification__all text-center\">\n                      {item}\n                   </DropdownItem>\n          ): <DropdownItem className=\"notification__all text-center\">\n          No new notifications.\n        </DropdownItem> }\n\n          {/* <DropdownItem className=\"notification__all text-center\">\n            No new notifications.\n          </DropdownItem> */}\n        </Collapse>\n      </NavItem>\n    );\n  }\n}\n\nexport default withRouter(Notifications);"]},"metadata":{},"sourceType":"module"}
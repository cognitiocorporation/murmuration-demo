{"ast":null,"code":"import _regeneratorRuntime from \"/usr/local/lib/node_modules/react-scripts/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/usr/local/lib/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/usr/local/lib/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"/Users/angelvazquez/Dropbox/My Mac (Angels-MacBook-Pro-4.local)/Documents/Projects/Murmuration - 10:04:2021/src/views/AdministrationComite.js\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nimport { Container, Row, Col, Button, ButtonGroup, Modal, ModalHeader, ModalBody, ListGroup, ListGroupItem } from \"shards-react\";\nimport PageTitle from \"../components/common/PageTitle\";\nimport Editor from \"../components/add-new-post/Editor\";\nimport SidebarActions from \"../components/add-new-post/SidebarActions\";\nimport IdeaCategories from \"../components/administration/IdeaCategories\";\nimport Departments from \"../components/administration/Departments\";\nimport Questions from \"../components/administration/Questions\";\nimport PropertyManager from \"../components/administration/PropertyManager\";\nimport CompleteFormExample from \"../components/components-overview/CompleteFormExample\";\nimport NewUser from \"../components/components-overview/NewUser\";\nimport IdeaQuestions from \"../components/ecommerce/IdeaQuestions\";\nimport UserList from \"../components/ecommerce/UserList\";\nimport CreateCommiteeForm from \"../components/components-overview/CreateCommiteeForm\";\nimport UserTeams from \"./../components/user-profile/UserTeams\";\nimport { useTranslation, initReactI18next } from \"react-i18next\";\nimport Parse from 'parse';\nimport { useState, setValue } from 'react';\nimport { useFlexLayout } from \"react-table\";\nimport Select from 'react-select';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction AdministrationComite() {\n  _s();\n\n  var _this = this;\n\n  var _useTranslation = useTranslation(),\n      t = _useTranslation.t;\n\n  var _useState = useState(0),\n      _useState2 = _slicedToArray(_useState, 2),\n      open = _useState2[0],\n      setOpen = _useState2[1];\n\n  var _useState3 = useState(1),\n      _useState4 = _slicedToArray(_useState3, 2),\n      modalTitle = _useState4[0],\n      setModalTitle = _useState4[1];\n\n  var _useState5 = useState(1),\n      _useState6 = _slicedToArray(_useState5, 2),\n      cData = _useState6[0],\n      setcData = _useState6[1];\n\n  var _useState7 = useState([]),\n      _useState8 = _slicedToArray(_useState7, 2),\n      modalMembers = _useState8[0],\n      setModalMembers = _useState8[1];\n\n  var _useState9 = useState([]),\n      _useState10 = _slicedToArray(_useState9, 2),\n      selectedMembers = _useState10[0],\n      setSelectedMembers = _useState10[1];\n\n  var _useState11 = useState([]),\n      _useState12 = _slicedToArray(_useState11, 2),\n      coms = _useState12[0],\n      setComs = _useState12[1];\n\n  var _useState13 = useState([]),\n      _useState14 = _slicedToArray(_useState13, 2),\n      options = _useState14[0],\n      setOptions = _useState14[1];\n\n  var handleModalOpen = function handleModalOpen(data) {\n    fetchCategoryData(); // Set Data\n\n    setcData(data);\n    setModalTitle(data.get(\"name\"));\n    setModalMembers(data.get(\"members\"));\n    console.log(data.get(\"members\"));\n    var newOpen = !open;\n    setOpen(newOpen);\n  };\n\n  var fetchCategoryData = function fetchCategoryData() {\n    var className = \"User\";\n    var ItemClass = Parse.Object.extend(className);\n    var query = new Parse.Query(ItemClass);\n    query.limit(1000);\n    query.ascending(\"firstName\").find().then(function (results) {\n      var myOptions = [];\n      {\n        results.map(function (result, idx) {\n          return myOptions.push({\n            \"value\": result,\n            \"label\": getFullName(result)\n          });\n        });\n      }\n      setOptions(myOptions); // this.props.setResponsible(results[0], -1);\n    }, function (error) {\n      setOptions([]); // The object was not retrieved successfully.\n      // error is a Parse.Error with an error code and message.\n    });\n  };\n\n  var addMembers = function addMembers(members) {\n    // const { committees } = this.state;\n    // const oldComms = commitees; \n    // oldComms.push({\"name\":\" \", \"email\": \" \" });\n    console.log(members); //   this.setState(prevState => ({\n    //     committees: prevState.committees.concat({\"name\":\" \", \"email\": \" \" })\n    // }));\n\n    setSelectedMembers(members); // this.setState({value: this.props.value});\n  };\n\n  var handleModalClose = function handleModalClose(data) {\n    // Set Data\n    var newOpen = !open;\n    setOpen(newOpen);\n  };\n\n  var getFullName = function getFullName(result) {\n    if (result) {\n      return result.get(\"firstName\") + ' ' + result.get(\"lastName\");\n    }\n  };\n\n  var deleteAllIdeas = function deleteAllIdeas() {\n    var shouldDeleteIdeas = window.confirm(t('RESET_MSG'));\n\n    if (shouldDeleteIdeas) {\n      var Idea = new Parse.Schema('Idea'); // var ideas = new Idea();\n\n      Idea.purge().then(function () {\n        console.log('IDEAS DELETED');\n      });\n    }\n  };\n\n  var removeUser = function removeUser(item, i) {\n    // Remover el \"Value\" del EvaluationCommittee de la lista de \"evaluationCriteria\" del usuario.\n    // Una vez el paso anterior hay sido succesfull, elimina al usuario de la lista de \"members\" del EvaluationCommittee\n    // Necesito el User object y el EvaluationCommittee object\n    deleteSelectedCriteria(item.value);\n  };\n\n  var deleteSelectedCriteria = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(item) {\n      var evalCriteria, cEvaluatingBy, filteredCriteria, query, myUser;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              evalCriteria = item.get(\"evaluationCriteria\");\n              cEvaluatingBy = cData.get(\"value\");\n              filteredCriteria = evalCriteria.filter(function (e) {\n                return e !== cEvaluatingBy;\n              });\n              console.log(cEvaluatingBy);\n              console.log(evalCriteria);\n              console.log(filteredCriteria); // item.save('', {useMasterKey: true})\n              // .then((userData) => {\n              //   // The object was retrieved successfully.\n              //   console.log(userData);\n              // }, (error) => {\n              //   // The object was not retrieved successfully.\n              //   // error is a Parse.Error with an error code and message.\n              //   console.log(error);\n              // });\n\n              query = new Parse.Query(Parse.User);\n              _context.next = 9;\n              return query.get(item.id);\n\n            case 9:\n              myUser = _context.sent;\n              myUser.set(\"evaluationCriteria\", filteredCriteria);\n              Parse.Object.saveAll([myUser], {\n                useMasterKey: true\n              }).then(function () {\n                deleteUserFromC(myUser);\n              }); // this.setNotifications();\n\n            case 12:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function deleteSelectedCriteria(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var deleteUserFromC = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(myUser) {\n      var currMembers, filteredMembers;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              currMembers = cData.get(\"members\");\n              filteredMembers = currMembers.filter(function (e, i) {\n                return e.value.id !== myUser.id;\n              });\n              cData.set(\"members\", filteredMembers);\n              Parse.Object.saveAll([cData], {\n                useMasterKey: true\n              }).then(function () {\n                if (window.confirm('¡La operacion fue exitosa!')) {\n                  window.location.reload();\n                }\n\n                ;\n              });\n\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function deleteUserFromC(_x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var addUsers = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(myUser) {\n      var allMembers, evaluationType, value, parseObjs;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              // const currMembers = cData.get(\"members\")\n              // var filteredMembers = currMembers.filter(function(e, i) { return e.value.id !== myUser.id })\n              // cData.set(\"members\", filteredMembers)\n              // Parse.Object.saveAll([cData], {useMasterKey: true}).then(() => {\n              //   if(window.confirm('¡La operacion fue exitosa!')) {\n              //     window.location.reload()\n              //   };\n              // });\n              allMembers = modalMembers.concat(selectedMembers);\n              console.log(modalMembers);\n              cData.set(\"members\", allMembers);\n              evaluationType = cData.get(\"evaluationType\");\n              value = cData.get(\"value\");\n              parseObjs = [];\n              Parse.Object.saveAll([cData], {\n                useMasterKey: true\n              }).then(function (item) {\n                if (evaluationType == 'manage') {\n                  selectedMembers.forEach(function (obj) {\n                    var member = obj.value;\n\n                    if (member.get(\"role\") != 'super_user') {\n                      var type = getType(value);\n\n                      if (value == 'PMO') {\n                        member.set(\"pmo\", true);\n                      }\n\n                      member.set(\"role\", type);\n                      parseObjs.push(member);\n                    }\n                  });\n                } else {\n                  selectedMembers.forEach(function (obj) {\n                    var member = obj.value;\n\n                    if (member.get(\"role\") != 'super_user') {\n                      var evaluationCriteria = member.get(\"evaluationCriteria\");\n                      evaluationCriteria.push(value);\n                      member.set(\"role\", 'evaluation');\n                      member.set(\"evaluationCriteria\", evaluationCriteria);\n                      parseObjs.push(member);\n                    }\n                  });\n                }\n\n                Parse.Object.saveAll(parseObjs, {\n                  useMasterKey: true\n                }).then(function () {\n                  alert('¡La operacion fue exitosa!');\n                }, function (error) {\n                  console.log(error); // Execute any logic that should take place if the save fails.\n                  // error is a Parse.Error with an error code and message.\n\n                  alert('Hubo un error en la operacion: ' + error.message);\n                });\n              });\n\n            case 7:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function addUsers(_x3) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var getType = function getType(value) {\n    switch (value) {\n      case 'Evaluación':\n        // code block\n        return 'evaluation';\n\n      case 'Verificación':\n        // code block\n        return 'verification';\n\n      case 'Reconocimiento':\n        // code block\n        return 'recognition';\n\n      case 'PMO':\n        // code block\n        return 'evaluation';\n\n      default: // code block\n\n    }\n  }; // Get all committees\n\n\n  var setupNewCs = function setupNewCs() {\n    // Get all committees\n    // Go through every member in the committee and add the \"value\" to the \"evaluationCriteria\" array\n    // Go through every member in the committee and activate the respective boolean \"pmo\" or \"verificationType\"\n    // Update the user\n    // Save\n    var className = \"EvaluationCommittee\";\n    var ItemClass = Parse.Object.extend(className);\n    var query = new Parse.Query(ItemClass); // const loadData = () => {\n    // if (teams == '') {\n\n    query.find().then(function (results) {\n      console.log(results);\n      addNewCriteria(results);\n    }, function (error) {\n      alert('Hubo un error en la busqueda de comites de evaluacion.'); // The object was not retrieved successfully.\n      // error is a Parse.Error with an error code and message.\n    });\n  };\n\n  var addNewCriteria = function addNewCriteria(coms) {\n    // console.log('MY COMS')\n    // coms.forEach((comite, i) => console.log(comite));\n    var parseObjs = [];\n    coms.map(function (comite) {\n      var evaluationType = comite.get(\"evaluationType\");\n      var members = comite.get(\"members\");\n      var value = comite.get(\"value\");\n      console.log(comite);\n\n      if (evaluationType == 'manage') {\n        members.forEach(function (obj) {\n          console.log(obj);\n          var member = obj.value;\n\n          if (member.get(\"role\") != 'super_user') {\n            var type = getType(value);\n\n            if (value == 'PMO') {\n              member.set(\"pmo\", true);\n            }\n\n            member.set(\"role\", type);\n            parseObjs.push(member);\n          }\n        });\n      } else {\n        members.forEach(function (obj) {\n          console.log(obj);\n          var member = obj.value;\n\n          if (member.get(\"role\") != 'super_user') {\n            var evaluationCriteria = member.get(\"evaluationCriteria\");\n            evaluationCriteria.push(value);\n            member.set(\"role\", 'evaluation');\n            member.set(\"evaluationCriteria\", evaluationCriteria);\n            parseObjs.push(member);\n          }\n        });\n      }\n    });\n    Parse.Object.saveAll(parseObjs, {\n      useMasterKey: true\n    }).then(function () {\n      console.log(parseObjs);\n    });\n  };\n\n  var updateMembers = function updateMembers(members) {\n    members.map(function (member) {});\n  };\n\n  console.log(modalMembers);\n  console.log(options);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(Modal, {\n      open: open,\n      toggle: handleModalClose.bind(this),\n      children: [/*#__PURE__*/_jsxDEV(ModalHeader, {\n        children: modalTitle\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 313,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(ModalBody, {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"feInputAddress2\",\n          children: t('EVAL_COMMITTEE_MEMBER')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 315,\n          columnNumber: 7\n        }, this), /*#__PURE__*/_jsxDEV(ListGroup, {\n          children: [modalMembers.map(function (item, i) {\n            return /*#__PURE__*/_jsxDEV(Row, {\n              style: {\n                marginBottom: 10\n              },\n              children: [/*#__PURE__*/_jsxDEV(Col, {\n                md: 10,\n                children: /*#__PURE__*/_jsxDEV(ListGroupItem, {\n                  children: item.label\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 320,\n                  columnNumber: 15\n                }, _this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 319,\n                columnNumber: 13\n              }, _this), /*#__PURE__*/_jsxDEV(Col, {\n                style: {\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center'\n                },\n                children: /*#__PURE__*/_jsxDEV(Button, {\n                  theme: \"danger\",\n                  onClick: function onClick() {\n                    return removeUser(item, i);\n                  },\n                  children: \"x\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 323,\n                  columnNumber: 15\n                }, _this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 322,\n                columnNumber: 13\n              }, _this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 318,\n              columnNumber: 11\n            }, _this);\n          }), /*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"feInputAddress2\",\n            children: t('EVAL_COMMITTEE_ADD_MEMBERS')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 327,\n            columnNumber: 9\n          }, this), /*#__PURE__*/_jsxDEV(Select, {\n            value: selectedMembers,\n            onChange: function onChange(members) {\n              return addMembers(members);\n            },\n            isMulti: true,\n            options: options,\n            placeholder: 'Seleccione Empleados',\n            clearable: false\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 328,\n            columnNumber: 9\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            disabled: selectedMembers ? selectedMembers.length == 0 : true,\n            onClick: function onClick() {\n              return addUsers();\n            },\n            children: t('EVAL_COMMITTEE_ADD')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 336,\n            columnNumber: 9\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 316,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 314,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 312,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(Container, {\n      fluid: true,\n      className: \"main-content-container px-4 pb-4\",\n      children: [/*#__PURE__*/_jsxDEV(Row, {\n        noGutters: true,\n        className: \"page-header py-4\",\n        children: [/*#__PURE__*/_jsxDEV(PageTitle, {\n          sm: \"4\",\n          title: t('ADMINISTRATION_TITLE'),\n          subtitle: t('ADMINISTRATION_SUBTITLE'),\n          className: \"text-sm-left\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 350,\n          columnNumber: 5\n        }, this), /*#__PURE__*/_jsxDEV(Col, {\n          xs: \"12\",\n          sm: \"8\",\n          className: \"col d-flex align-items-center\",\n          children: /*#__PURE__*/_jsxDEV(ButtonGroup, {\n            size: \"sm\",\n            className: \"d-inline-flex mb-3 mb-sm-0 mx-auto\",\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              theme: \"white\",\n              onClick: function onClick() {\n                return deleteAllIdeas();\n              },\n              children: t('RESET')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 355,\n              columnNumber: 11\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 354,\n            columnNumber: 9\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 353,\n          columnNumber: 7\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 349,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(Row, {\n        children: [/*#__PURE__*/_jsxDEV(Col, {\n          lg: \"6\",\n          md: \"6\",\n          children: /*#__PURE__*/_jsxDEV(CreateCommiteeForm, {\n            title: t('EVAL_COMMITTEES')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 384,\n            columnNumber: 9\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 383,\n          columnNumber: 7\n        }, this), /*#__PURE__*/_jsxDEV(Col, {\n          lg: \"6\",\n          md: \"6\",\n          children: /*#__PURE__*/_jsxDEV(UserTeams, {\n            toggle: handleModalOpen.bind(this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 387,\n            columnNumber: 9\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 386,\n          columnNumber: 7\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 382,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 347,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 308,\n    columnNumber: 5\n  }, this);\n}\n\n_s(AdministrationComite, \"QyB+kH7T2c6U7UHDqr6cIVJLOQg=\", false, function () {\n  return [useTranslation];\n});\n\n_c = AdministrationComite;\nexport default AdministrationComite;\n\nvar _c;\n\n$RefreshReg$(_c, \"AdministrationComite\");","map":{"version":3,"sources":["/Users/angelvazquez/Dropbox/My Mac (Angels-MacBook-Pro-4.local)/Documents/Projects/Murmuration - 10:04:2021/src/views/AdministrationComite.js"],"names":["React","Container","Row","Col","Button","ButtonGroup","Modal","ModalHeader","ModalBody","ListGroup","ListGroupItem","PageTitle","Editor","SidebarActions","IdeaCategories","Departments","Questions","PropertyManager","CompleteFormExample","NewUser","IdeaQuestions","UserList","CreateCommiteeForm","UserTeams","useTranslation","initReactI18next","Parse","useState","setValue","useFlexLayout","Select","AdministrationComite","t","open","setOpen","modalTitle","setModalTitle","cData","setcData","modalMembers","setModalMembers","selectedMembers","setSelectedMembers","coms","setComs","options","setOptions","handleModalOpen","data","fetchCategoryData","get","console","log","newOpen","className","ItemClass","Object","extend","query","Query","limit","ascending","find","then","results","myOptions","map","result","idx","push","getFullName","error","addMembers","members","handleModalClose","deleteAllIdeas","shouldDeleteIdeas","window","confirm","Idea","Schema","purge","removeUser","item","i","deleteSelectedCriteria","value","evalCriteria","cEvaluatingBy","filteredCriteria","filter","e","User","id","myUser","set","saveAll","useMasterKey","deleteUserFromC","currMembers","filteredMembers","location","reload","addUsers","allMembers","concat","evaluationType","parseObjs","forEach","obj","member","type","getType","evaluationCriteria","alert","message","setupNewCs","addNewCriteria","comite","updateMembers","bind","marginBottom","label","display","alignItems","justifyContent","length"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { Container, Row, Col, Button, ButtonGroup, Modal, ModalHeader, ModalBody, ListGroup, ListGroupItem } from \"shards-react\";\n\nimport PageTitle from \"../components/common/PageTitle\";\nimport Editor from \"../components/add-new-post/Editor\";\nimport SidebarActions from \"../components/add-new-post/SidebarActions\";\nimport IdeaCategories from \"../components/administration/IdeaCategories\";\nimport Departments from \"../components/administration/Departments\";\nimport Questions from \"../components/administration/Questions\";\nimport PropertyManager from \"../components/administration/PropertyManager\";\nimport CompleteFormExample from \"../components/components-overview/CompleteFormExample\";\nimport NewUser from \"../components/components-overview/NewUser\";\nimport IdeaQuestions from \"../components/ecommerce/IdeaQuestions\";\nimport UserList from \"../components/ecommerce/UserList\";\nimport CreateCommiteeForm from \"../components/components-overview/CreateCommiteeForm\";\nimport UserTeams from \"./../components/user-profile/UserTeams\";\nimport { useTranslation, initReactI18next } from \"react-i18next\";\nimport Parse from 'parse';\nimport { useState, setValue } from 'react';\nimport { useFlexLayout } from \"react-table\";\nimport Select from 'react-select';\n\n\nfunction AdministrationComite() {\n  const { t } = useTranslation();\n\n  const [open, setOpen] = useState(0);\n  const [modalTitle, setModalTitle] = useState(1);\n  const [cData, setcData] = useState(1);\n  const [modalMembers, setModalMembers] = useState([]);\n  const [selectedMembers, setSelectedMembers] = useState([])\n  const [coms, setComs] = useState([]);\n  const [options, setOptions] = useState([]);\n\n  const handleModalOpen = (data) => {\n    fetchCategoryData();\n    // Set Data\n    setcData(data)\n    setModalTitle(data.get(\"name\"))\n    setModalMembers(data.get(\"members\"))\n    console.log(data.get(\"members\"))\n    const newOpen = !open;\n    setOpen(newOpen);\n  }\n\n  const fetchCategoryData = () => {\n    const className = \"User\";\n\n    var ItemClass = Parse.Object.extend(className);\n    var query = new Parse.Query(ItemClass);\n    query.limit(1000)\n    query.ascending(\"firstName\").find()\n    .then((results) => {\n        const myOptions = []\n        {\n            results.map((result, idx) => myOptions.push({\"value\":result, \"label\":getFullName(result)}))\n        }\n        \n        setOptions(myOptions)\n        // this.props.setResponsible(results[0], -1);\n    }, (error) => {\n        setOptions([])\n      // The object was not retrieved successfully.\n      // error is a Parse.Error with an error code and message.\n    });\n  }\n\n  const addMembers = (members) => {\n    // const { committees } = this.state;\n    // const oldComms = commitees; \n    // oldComms.push({\"name\":\" \", \"email\": \" \" });\n    console.log(members)\n  //   this.setState(prevState => ({\n  //     committees: prevState.committees.concat({\"name\":\" \", \"email\": \" \" })\n  // }));\n    setSelectedMembers(members)\n    // this.setState({value: this.props.value});\n  }\n\n  const handleModalClose = (data) => {\n    // Set Data\n    const newOpen = !open;\n    setOpen(newOpen);\n  }\n\n\n  const getFullName = (result) => {\n    if (result) {\n        return result.get(\"firstName\") + ' ' + result.get(\"lastName\");\n    }\n  }\n\n  const deleteAllIdeas = () => {\n    var shouldDeleteIdeas = window.confirm(t('RESET_MSG'));\n    if (shouldDeleteIdeas) {\n      var Idea =  new Parse.Schema('Idea');\n      // var ideas = new Idea();\n      Idea.purge().then(()=> {\n        console.log('IDEAS DELETED')\n      })\n    }\n  }\n\n  const removeUser = (item, i) => {\n    // Remover el \"Value\" del EvaluationCommittee de la lista de \"evaluationCriteria\" del usuario.\n    // Una vez el paso anterior hay sido succesfull, elimina al usuario de la lista de \"members\" del EvaluationCommittee\n    // Necesito el User object y el EvaluationCommittee object\n    deleteSelectedCriteria(item.value)\n  }\n\n  const deleteSelectedCriteria = async (item) => {\n    const evalCriteria = item.get(\"evaluationCriteria\")\n    const cEvaluatingBy = cData.get(\"value\")\n    var filteredCriteria = evalCriteria.filter(function(e) { return e !== cEvaluatingBy })\n    console.log(cEvaluatingBy)\n    console.log(evalCriteria)\n    console.log(filteredCriteria)\n    // item.save('', {useMasterKey: true})\n    // .then((userData) => {\n    //   // The object was retrieved successfully.\n    //   console.log(userData);\n    // }, (error) => {\n    //   // The object was not retrieved successfully.\n    //   // error is a Parse.Error with an error code and message.\n    //   console.log(error);\n    // });\n    const query = new Parse.Query(Parse.User);\n    const myUser = await query.get(item.id)\n    myUser.set(\"evaluationCriteria\", filteredCriteria)\n    Parse.Object.saveAll([myUser], {useMasterKey: true}).then(() => {\n      deleteUserFromC(myUser)\n    });\n    \n    // this.setNotifications();\n  }\n\n  const deleteUserFromC = async(myUser) => {\n    const currMembers = cData.get(\"members\")\n    var filteredMembers = currMembers.filter(function(e, i) { return e.value.id !== myUser.id })\n    \n\n    cData.set(\"members\", filteredMembers)\n    Parse.Object.saveAll([cData], {useMasterKey: true}).then(() => {\n      if(window.confirm('¡La operacion fue exitosa!')) {\n        window.location.reload()\n      };\n    });\n  }\n\n  const addUsers = async(myUser) => {\n    // const currMembers = cData.get(\"members\")\n    // var filteredMembers = currMembers.filter(function(e, i) { return e.value.id !== myUser.id })\n\n    // cData.set(\"members\", filteredMembers)\n    // Parse.Object.saveAll([cData], {useMasterKey: true}).then(() => {\n    //   if(window.confirm('¡La operacion fue exitosa!')) {\n    //     window.location.reload()\n    //   };\n    // });\n    const allMembers = modalMembers.concat(selectedMembers)\n    console.log(modalMembers)\n   \n\n    cData.set(\"members\", allMembers);\n\n\n    var evaluationType = cData.get(\"evaluationType\")\n    var value = cData.get(\"value\")\n    var parseObjs = []\n    Parse.Object.saveAll([cData], {useMasterKey: true})\n    .then((item) => {\n      if (evaluationType == 'manage') {\n        selectedMembers.forEach((obj) => {\n          const member = obj.value\n          if (member.get(\"role\") != 'super_user') {\n            const type = getType(value)\n  \n            if (value == 'PMO') {\n              member.set(\"pmo\", true);\n            }\n            \n            member.set(\"role\", type);\n            parseObjs.push(member);\n          }\n          \n      });\n      } else {\n        selectedMembers.forEach((obj) => {\n          const member = obj.value\n          if (member.get(\"role\") != 'super_user') {\n  \n            var evaluationCriteria = member.get(\"evaluationCriteria\")\n            evaluationCriteria.push(value)\n            member.set(\"role\", 'evaluation');\n            member.set(\"evaluationCriteria\", evaluationCriteria);\n            parseObjs.push(member);\n          }\n        });\n      }\n  \n      Parse.Object.saveAll(parseObjs, {useMasterKey: true}).then(() => {\n        alert('¡La operacion fue exitosa!');\n      }, (error) => {\n        console.log(error)\n        // Execute any logic that should take place if the save fails.\n        // error is a Parse.Error with an error code and message.\n        alert('Hubo un error en la operacion: ' + error.message);\n      });\n    \n    })\n  }\n\n  const getType = (value) => {\n    switch(value) {\n      case 'Evaluación':\n        // code block\n        return 'evaluation'\n      case 'Verificación':\n        // code block\n        return 'verification'\n      case 'Reconocimiento':\n        // code block\n        return 'recognition'\n      case 'PMO':\n        // code block\n        return 'evaluation'\n      default:\n        // code block\n    }\n  }\n\n  // Get all committees\n  const setupNewCs = () => {\n    // Get all committees\n    // Go through every member in the committee and add the \"value\" to the \"evaluationCriteria\" array\n    // Go through every member in the committee and activate the respective boolean \"pmo\" or \"verificationType\"\n    // Update the user\n    // Save\n    const className = \"EvaluationCommittee\";\n    var ItemClass = Parse.Object.extend(className);\n    var query = new Parse.Query(ItemClass);\n    // const loadData = () => {\n    // if (teams == '') {\n    query.find()\n    .then((results) => {\n        console.log(results);\n        addNewCriteria(results)\n    }, (error) => {\n      alert('Hubo un error en la busqueda de comites de evaluacion.');\n      // The object was not retrieved successfully.\n      // error is a Parse.Error with an error code and message.\n    });     \n  }\n\n  const addNewCriteria = (coms) => {\n    // console.log('MY COMS')\n    // coms.forEach((comite, i) => console.log(comite));\n    var parseObjs = []\n    coms.map((comite) => {\n      const evaluationType = comite.get(\"evaluationType\")\n      const members = comite.get(\"members\")\n      const value = comite.get(\"value\")\n      console.log(comite)\n      if (evaluationType == 'manage') {\n        members.forEach((obj) => {\n          console.log(obj)\n          const member = obj.value\n          if (member.get(\"role\") != 'super_user') {\n            const type = getType(value)\n\n            if (value == 'PMO') {\n              member.set(\"pmo\", true);\n            }\n            member.set(\"role\", type);\n            parseObjs.push(member);\n          }\n          \n      });\n      } else {\n        members.forEach((obj) => {\n          console.log(obj)\n          const member = obj.value\n          if (member.get(\"role\") != 'super_user') {\n\n            var evaluationCriteria = member.get(\"evaluationCriteria\")\n            evaluationCriteria.push(value)\n            member.set(\"role\", 'evaluation');\n            member.set(\"evaluationCriteria\", evaluationCriteria);\n            parseObjs.push(member);\n          }\n        });\n      }\n      })\n      Parse.Object.saveAll(parseObjs, {useMasterKey: true}).then(() => {\n        console.log(parseObjs)\n      });\n  }\n\n  const updateMembers = (members) => {\n    members.map((member) => {\n\n    })\n  }\n\n  console.log(modalMembers)\n  console.log(options)\n  return(\n    <div>\n\n    {/* Eval Committee Modal*/}\n\n    <Modal open={open} toggle={handleModalClose.bind(this)}>\n      <ModalHeader>{modalTitle}</ModalHeader>\n      <ModalBody>\n      <label htmlFor=\"feInputAddress2\">{t('EVAL_COMMITTEE_MEMBER')}</label>\n        <ListGroup>\n        {modalMembers.map((item,i) => \n          <Row style={{marginBottom: 10}}>\n            <Col md={10}>\n              <ListGroupItem>{item.label}</ListGroupItem>\n            </Col>\n            <Col style={{display: 'flex', alignItems: 'center', justifyContent: 'center'}}>\n              <Button theme=\"danger\" onClick={() => removeUser(item, i)}>x</Button>\n            </Col>\n            </Row>\n        )}\n        <label htmlFor=\"feInputAddress2\">{t('EVAL_COMMITTEE_ADD_MEMBERS')}</label>\n        <Select\n            value={selectedMembers}\n            onChange={(members) => addMembers(members)}\n            isMulti\n            options={options}\n            placeholder={'Seleccione Empleados'}\n            clearable={false}\n        />\n        <Button disabled={selectedMembers?selectedMembers.length == 0:true} onClick={() => addUsers()}>{t('EVAL_COMMITTEE_ADD')}</Button>\n          {/* <ListGroupItem>Cras justo odio</ListGroupItem>\n          <ListGroupItem>Dapibus ac facilisis in</ListGroupItem>\n          <ListGroupItem>Morbi leo risus</ListGroupItem>\n          <ListGroupItem>Porta ac consectetur ac</ListGroupItem>\n          <ListGroupItem>Vestibulum at eros</ListGroupItem> */}\n        </ListGroup>\n        \n      </ModalBody>\n    </Modal>\n\n    <Container fluid className=\"main-content-container px-4 pb-4\">\n    {/* Page Header */}\n    <Row noGutters className=\"page-header py-4\">\n    <PageTitle sm=\"4\" title={t('ADMINISTRATION_TITLE')} subtitle={t('ADMINISTRATION_SUBTITLE')} className=\"text-sm-left\" />\n\n      {/* Page Header :: Actions */}\n      <Col xs=\"12\" sm=\"8\" className=\"col d-flex align-items-center\">\n        <ButtonGroup size=\"sm\" className=\"d-inline-flex mb-3 mb-sm-0 mx-auto\">\n          <Button theme=\"white\" onClick={() => deleteAllIdeas()}>\n            {t('RESET')}\n          </Button>\n          {/* <Button theme=\"white\" tag={NavLink} to=\"/historial-reconocimiento\">\n            History\n          </Button> */}\n        </ButtonGroup>\n      </Col>\n    </Row>\n    {/* <Row>\n      <Col lg=\"8\" md=\"12\">\n        <UserList/>\n      </Col>\n      <Col lg=\"4\" md=\"12\">\n        <NewUser/>\n      </Col>\n    </Row> */}\n    {/* <Row noGutters className=\"page-header py-4\">\n      <PageTitle sm=\"4\" title={t('ADMINISTRATION_TITLE')} subtitle={t('ADMINISTRATION_SUBTITLE')} className=\"text-sm-left\" />\n    </Row>\n    <Row noGutters>\n      <PageTitle sm=\"4\" title={t('ADMINISTRATION_TITLE')} subtitle={t('ADMINISTRATION_SUBTITLE')} className=\"text-sm-left\" />\n      <Button pill outline size=\"sm\" theme=\"danger\">\n        <i class=\"fas fa-eye\"></i>\n      </Button>\n      \n    </Row> */}\n    <Row>\n      <Col lg=\"6\" md=\"6\">\n        <CreateCommiteeForm title={t('EVAL_COMMITTEES')}/>\n      </Col>\n      <Col lg=\"6\" md=\"6\">\n        <UserTeams toggle={handleModalOpen.bind(this)} />\n      </Col>\n    </Row>\n    {/* <Row> */}\n      {/* Sidebar Widgets */}\n      {/* <Col lg=\"3\" md=\"12\">\n        <PropertyManager title=\"Categorias\" className=\"IdeaCategory\" actionTitle=\"Nueva Categoria\"/>\n      </Col>\n      <Col lg=\"3\" md=\"12\">\n        <PropertyManager title=\"Departamentos\" className=\"IdeaDepartment\" actionTitle=\"Nuevo Departamento\"/>\n      </Col> */}\n      {/* <Col lg=\"3\" md=\"12\">\n        <PropertyManager title={t('CATEGORIES')} className=\"IdeaCategory\" actionTitle=\"Nueva Categoria\"/>\n      </Col>\n      <Col lg=\"3\" md=\"12\">\n        <PropertyManager title={t('DEPARTMENTS')} className=\"IdeaDepartment\" actionTitle=\"New Department\"/>\n      </Col>\n      <Col lg=\"6\" md=\"12\">\n        <CompleteFormExample/>\n      </Col>\n      <Col lg=\"12\" md=\"12\">\n        <IdeaQuestions/>\n      </Col>\n    </Row> */}\n  </Container>\n  </div>\n  )\n}\n\nexport default AdministrationComite;"]},"metadata":{},"sourceType":"module"}